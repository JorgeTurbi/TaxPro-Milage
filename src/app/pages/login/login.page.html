<ion-content [fullscreen]="true">
    <div class="login-container">

        <!-- Logo de TaxPro Suite -->
        <div>
            <img src="../../../assets/logo/taxpro-millage.png" alt="TaxPro Suite" />
        </div>

        <!-- Tarjeta de Login -->
        <div class="login-card fade-in">

            <!-- Título -->
            <p class="login-subtitle">Inicia sesión para continuar</p>

            <!-- Formulario de Login -->
            <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">

                <!-- Campo Email -->
                <ion-input class="taxpro-input" type="email" formControlName="email" placeholder="Correo electrónico"
                    [clearInput]="true" autocomplete="email">
                    <ion-icon slot="start" name="mail-outline"></ion-icon>
                </ion-input>

                <!-- Error de Email -->
                @if (loginForm.get('email')?.touched && loginForm.get('email')?.errors) {
                <p class="error-text">
                    @if (loginForm.get('email')?.errors?.['required']) {
                    El correo es requerido
                    }
                    @if (loginForm.get('email')?.errors?.['email']) {
                    Ingresa un correo válido
                    }
                </p>
                }

                <!-- Campo Contraseña -->
                <ion-input class="taxpro-input" type="password" formControlName="password" placeholder="Contraseña"
                    autocomplete="current-password">
                    <ion-icon slot="start" name="lock-closed-outline"></ion-icon>
                    <ion-input-password-toggle slot="end"></ion-input-password-toggle>
                </ion-input>

                <!-- Error de Contraseña -->
                @if (loginForm.get('password')?.touched && loginForm.get('password')?.errors) {
                <p class="error-text">
                    @if (loginForm.get('password')?.errors?.['required']) {
                    La contraseña es requerida
                    }
                    @if (loginForm.get('password')?.errors?.['minlength']) {
                    Mínimo 6 caracteres
                    }
                </p>
                }

                <!-- Error General -->
                @if (errorMessage) {
                <div class="error-banner">
                    <ion-icon name="alert-circle-outline"></ion-icon>
                    <span>{{ errorMessage }}</span>
                </div>
                }

                <!-- Botón de Login -->
                <ion-button expand="block" type="submit" class="btn-taxpro" [disabled]="isLoading || loginForm.invalid">
                    @if (isLoading) {
                    <ion-spinner name="crescent"></ion-spinner>
                    } @else {
                    <ion-icon slot="start" name="log-in-outline"></ion-icon>
                    Iniciar Sesión
                    }
                </ion-button>

            </form>

            <!-- Separador -->
            @if (biometryAvailable) {
            <div class="separator">
                <span>o</span>
            </div>

            <!-- Botón de Biometría -->
            <div class="biometric-btn" (click)="loginWithBiometrics()">
                <ion-icon name="finger-print"></ion-icon>
                <span>{{ biometryType === 'faceId' ? 'Usar Face ID' : 'Usar huella digital' }}</span>
            </div>
            }

        </div>

        <!-- Versión de la app -->
        <p class="version-text">v1.0.0</p>

    </div>
</ion-content>